import{_ as n,c as a,o as l,ae as p}from"./chunks/framework.BXQRUG6O.js";const y=JSON.parse('{"title":"客户端接口","description":"","frontmatter":{},"headers":[],"relativePath":"zh/api/client.md","filePath":"zh/api/client.md","lastUpdated":null}'),o={name:"zh/api/client.md"};function e(t,s,r,c,D,F){return l(),a("div",null,s[0]||(s[0]=[p(`<h1 id="客户端接口" tabindex="-1">客户端接口 <a class="header-anchor" href="#客户端接口" aria-label="Permalink to &quot;客户端接口&quot;">​</a></h1><p><code>Client</code>接口是Go NPM SDK中所有npm操作的主要入口点。它提供了管理npm安装、包和项目的全面方法集。</p><h2 id="创建客户端" tabindex="-1">创建客户端 <a class="header-anchor" href="#创建客户端" aria-label="Permalink to &quot;创建客户端&quot;">​</a></h2><h3 id="newclient" tabindex="-1">NewClient <a class="header-anchor" href="#newclient" aria-label="Permalink to &quot;NewClient&quot;">​</a></h3><p>使用默认配置创建新的npm客户端。</p><div class="language-go line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#89DDFF;">func</span><span style="color:#82AAFF;"> NewClient</span><span style="color:#89DDFF;">()</span><span style="color:#89DDFF;"> (</span><span style="color:#FFCB6B;">Client</span><span style="color:#89DDFF;">,</span><span style="color:#C792EA;"> error</span><span style="color:#89DDFF;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><strong>示例:</strong></p><div class="language-go line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#BABED8;">client</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> err </span><span style="color:#89DDFF;">:=</span><span style="color:#BABED8;"> npm</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">NewClient</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#BABED8;"> err </span><span style="color:#89DDFF;">!=</span><span style="color:#89DDFF;"> nil</span><span style="color:#89DDFF;"> {</span></span>
<span class="line"><span style="color:#BABED8;">    log</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Fatal</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;">err</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="newclientwithpath" tabindex="-1">NewClientWithPath <a class="header-anchor" href="#newclientwithpath" aria-label="Permalink to &quot;NewClientWithPath&quot;">​</a></h3><p>使用特定的npm可执行文件路径创建新的npm客户端。</p><div class="language-go line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#89DDFF;">func</span><span style="color:#82AAFF;"> NewClientWithPath</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;font-style:italic;">npmPath</span><span style="color:#C792EA;"> string</span><span style="color:#89DDFF;">)</span><span style="color:#89DDFF;"> (</span><span style="color:#FFCB6B;">Client</span><span style="color:#89DDFF;">,</span><span style="color:#C792EA;"> error</span><span style="color:#89DDFF;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><strong>参数:</strong></p><ul><li><code>npmPath</code> (string): npm可执行文件的路径</li></ul><p><strong>示例:</strong></p><div class="language-go line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#BABED8;">client</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> err </span><span style="color:#89DDFF;">:=</span><span style="color:#BABED8;"> npm</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">NewClientWithPath</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">/usr/local/bin/npm</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#BABED8;"> err </span><span style="color:#89DDFF;">!=</span><span style="color:#89DDFF;"> nil</span><span style="color:#89DDFF;"> {</span></span>
<span class="line"><span style="color:#BABED8;">    log</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Fatal</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;">err</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="基本操作" tabindex="-1">基本操作 <a class="header-anchor" href="#基本操作" aria-label="Permalink to &quot;基本操作&quot;">​</a></h2><h3 id="isavailable" tabindex="-1">IsAvailable <a class="header-anchor" href="#isavailable" aria-label="Permalink to &quot;IsAvailable&quot;">​</a></h3><p>检查npm是否可用并可以执行。</p><div class="language-go line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#82AAFF;">IsAvailable</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;">ctx context</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">Context</span><span style="color:#89DDFF;">)</span><span style="color:#C792EA;"> bool</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><strong>参数:</strong></p><ul><li><code>ctx</code> (context.Context): 用于取消和超时的上下文</li></ul><p><strong>返回:</strong></p><ul><li><code>bool</code>: 如果npm可用返回true，否则返回false</li></ul><p><strong>示例:</strong></p><div class="language-go line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#BABED8;">ctx </span><span style="color:#89DDFF;">:=</span><span style="color:#BABED8;"> context</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Background</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#BABED8;"> client</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">IsAvailable</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;">ctx</span><span style="color:#89DDFF;">)</span><span style="color:#89DDFF;"> {</span></span>
<span class="line"><span style="color:#BABED8;">    fmt</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">npm可用</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#89DDFF;font-style:italic;"> else</span><span style="color:#89DDFF;"> {</span></span>
<span class="line"><span style="color:#BABED8;">    fmt</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">npm不可用</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h3 id="install" tabindex="-1">Install <a class="header-anchor" href="#install" aria-label="Permalink to &quot;Install&quot;">​</a></h3><p>如果系统上没有npm，则自动安装npm。</p><div class="language-go line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#82AAFF;">Install</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;">ctx context</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">Context</span><span style="color:#89DDFF;">)</span><span style="color:#C792EA;"> error</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><strong>参数:</strong></p><ul><li><code>ctx</code> (context.Context): 用于取消和超时的上下文</li></ul><p><strong>返回:</strong></p><ul><li><code>error</code>: 如果安装失败返回错误</li></ul><p><strong>示例:</strong></p><div class="language-go line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#BABED8;">ctx </span><span style="color:#89DDFF;">:=</span><span style="color:#BABED8;"> context</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Background</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#89DDFF;"> !</span><span style="color:#BABED8;">client</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">IsAvailable</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;">ctx</span><span style="color:#89DDFF;">)</span><span style="color:#89DDFF;"> {</span></span>
<span class="line"><span style="color:#BABED8;">    err </span><span style="color:#89DDFF;">:=</span><span style="color:#BABED8;"> client</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Install</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;">ctx</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">    if</span><span style="color:#BABED8;"> err </span><span style="color:#89DDFF;">!=</span><span style="color:#89DDFF;"> nil</span><span style="color:#89DDFF;"> {</span></span>
<span class="line"><span style="color:#BABED8;">        log</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Fatalf</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">安装npm失败: </span><span style="color:#F07178;">%v</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> err</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#89DDFF;">    }</span></span>
<span class="line"><span style="color:#BABED8;">    fmt</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">npm安装成功</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="version" tabindex="-1">Version <a class="header-anchor" href="#version" aria-label="Permalink to &quot;Version&quot;">​</a></h3><p>获取当前npm版本。</p><div class="language-go line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#82AAFF;">Version</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;">ctx context</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">Context</span><span style="color:#89DDFF;">)</span><span style="color:#89DDFF;"> (</span><span style="color:#C792EA;">string</span><span style="color:#89DDFF;">,</span><span style="color:#C792EA;"> error</span><span style="color:#89DDFF;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><strong>参数:</strong></p><ul><li><code>ctx</code> (context.Context): 用于取消和超时的上下文</li></ul><p><strong>返回:</strong></p><ul><li><code>string</code>: npm版本字符串</li><li><code>error</code>: 如果版本获取失败返回错误</li></ul><p><strong>示例:</strong></p><div class="language-go line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#BABED8;">ctx </span><span style="color:#89DDFF;">:=</span><span style="color:#BABED8;"> context</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Background</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#BABED8;">version</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> err </span><span style="color:#89DDFF;">:=</span><span style="color:#BABED8;"> client</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Version</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;">ctx</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#BABED8;"> err </span><span style="color:#89DDFF;">!=</span><span style="color:#89DDFF;"> nil</span><span style="color:#89DDFF;"> {</span></span>
<span class="line"><span style="color:#BABED8;">    log</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Fatalf</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">获取npm版本失败: </span><span style="color:#F07178;">%v</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> err</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#BABED8;">fmt</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Printf</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">npm版本: </span><span style="color:#F07178;">%s</span><span style="color:#BABED8;">\\n</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> version</span><span style="color:#89DDFF;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h2 id="项目管理" tabindex="-1">项目管理 <a class="header-anchor" href="#项目管理" aria-label="Permalink to &quot;项目管理&quot;">​</a></h2><h3 id="init" tabindex="-1">Init <a class="header-anchor" href="#init" aria-label="Permalink to &quot;Init&quot;">​</a></h3><p>使用package.json初始化新的npm项目。</p><div class="language-go line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#82AAFF;">Init</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;">ctx context</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">Context</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> options InitOptions</span><span style="color:#89DDFF;">)</span><span style="color:#C792EA;"> error</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><strong>参数:</strong></p><ul><li><code>ctx</code> (context.Context): 用于取消和超时的上下文</li><li><code>options</code> (InitOptions): 初始化选项</li></ul><p><strong>返回:</strong></p><ul><li><code>error</code>: 如果初始化失败返回错误</li></ul><p><strong>示例:</strong></p><div class="language-go line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#BABED8;">ctx </span><span style="color:#89DDFF;">:=</span><span style="color:#BABED8;"> context</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Background</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#BABED8;">options </span><span style="color:#89DDFF;">:=</span><span style="color:#FFCB6B;"> npm</span><span style="color:#89DDFF;">.</span><span style="color:#FFCB6B;">InitOptions</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#BABED8;">    Name</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;">        &quot;</span><span style="color:#C3E88D;">my-project</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#BABED8;">    Version</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;">     &quot;</span><span style="color:#C3E88D;">1.0.0</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#BABED8;">    Description</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">我的项目</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#BABED8;">    Author</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;">      &quot;</span><span style="color:#C3E88D;">张三</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#BABED8;">    License</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;">     &quot;</span><span style="color:#C3E88D;">MIT</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#BABED8;">    WorkingDir</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;">  &quot;</span><span style="color:#C3E88D;">/path/to/project</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">err </span><span style="color:#89DDFF;">:=</span><span style="color:#BABED8;"> client</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Init</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;">ctx</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> options</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#BABED8;"> err </span><span style="color:#89DDFF;">!=</span><span style="color:#89DDFF;"> nil</span><span style="color:#89DDFF;"> {</span></span>
<span class="line"><span style="color:#BABED8;">    log</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Fatalf</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">初始化项目失败: </span><span style="color:#F07178;">%v</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> err</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h2 id="包操作" tabindex="-1">包操作 <a class="header-anchor" href="#包操作" aria-label="Permalink to &quot;包操作&quot;">​</a></h2><h3 id="installpackage" tabindex="-1">InstallPackage <a class="header-anchor" href="#installpackage" aria-label="Permalink to &quot;InstallPackage&quot;">​</a></h3><p>安装特定的npm包。</p><div class="language-go line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#82AAFF;">InstallPackage</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;">ctx context</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">Context</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> pkg </span><span style="color:#C792EA;">string</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> options InstallOptions</span><span style="color:#89DDFF;">)</span><span style="color:#C792EA;"> error</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><strong>参数:</strong></p><ul><li><code>ctx</code> (context.Context): 用于取消和超时的上下文</li><li><code>pkg</code> (string): 要安装的包名</li><li><code>options</code> (InstallOptions): 安装选项</li></ul><p><strong>返回:</strong></p><ul><li><code>error</code>: 如果安装失败返回错误</li></ul><p><strong>示例:</strong></p><div class="language-go line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#BABED8;">ctx </span><span style="color:#89DDFF;">:=</span><span style="color:#BABED8;"> context</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Background</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#BABED8;">options </span><span style="color:#89DDFF;">:=</span><span style="color:#FFCB6B;"> npm</span><span style="color:#89DDFF;">.</span><span style="color:#FFCB6B;">InstallOptions</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#BABED8;">    SaveDev</span><span style="color:#89DDFF;">:</span><span style="color:#FF9CAC;">    true</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#BABED8;">    SaveExact</span><span style="color:#89DDFF;">:</span><span style="color:#FF9CAC;">  true</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#BABED8;">    WorkingDir</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">/path/to/project</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">err </span><span style="color:#89DDFF;">:=</span><span style="color:#BABED8;"> client</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">InstallPackage</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;">ctx</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">typescript</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> options</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#BABED8;"> err </span><span style="color:#89DDFF;">!=</span><span style="color:#89DDFF;"> nil</span><span style="color:#89DDFF;"> {</span></span>
<span class="line"><span style="color:#BABED8;">    log</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Fatalf</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">安装包失败: </span><span style="color:#F07178;">%v</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> err</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h3 id="uninstallpackage" tabindex="-1">UninstallPackage <a class="header-anchor" href="#uninstallpackage" aria-label="Permalink to &quot;UninstallPackage&quot;">​</a></h3><p>卸载特定的npm包。</p><div class="language-go line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#82AAFF;">UninstallPackage</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;">ctx context</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">Context</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> pkg </span><span style="color:#C792EA;">string</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> options UninstallOptions</span><span style="color:#89DDFF;">)</span><span style="color:#C792EA;"> error</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><strong>参数:</strong></p><ul><li><code>ctx</code> (context.Context): 用于取消和超时的上下文</li><li><code>pkg</code> (string): 要卸载的包名</li><li><code>options</code> (UninstallOptions): 卸载选项</li></ul><p><strong>返回:</strong></p><ul><li><code>error</code>: 如果卸载失败返回错误</li></ul><p><strong>示例:</strong></p><div class="language-go line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#BABED8;">ctx </span><span style="color:#89DDFF;">:=</span><span style="color:#BABED8;"> context</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Background</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#BABED8;">options </span><span style="color:#89DDFF;">:=</span><span style="color:#FFCB6B;"> npm</span><span style="color:#89DDFF;">.</span><span style="color:#FFCB6B;">UninstallOptions</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#BABED8;">    SaveDev</span><span style="color:#89DDFF;">:</span><span style="color:#FF9CAC;">    true</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#BABED8;">    WorkingDir</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">/path/to/project</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">err </span><span style="color:#89DDFF;">:=</span><span style="color:#BABED8;"> client</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">UninstallPackage</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;">ctx</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">typescript</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> options</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#BABED8;"> err </span><span style="color:#89DDFF;">!=</span><span style="color:#89DDFF;"> nil</span><span style="color:#89DDFF;"> {</span></span>
<span class="line"><span style="color:#BABED8;">    log</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Fatalf</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">卸载包失败: </span><span style="color:#F07178;">%v</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> err</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h3 id="updatepackage" tabindex="-1">UpdatePackage <a class="header-anchor" href="#updatepackage" aria-label="Permalink to &quot;UpdatePackage&quot;">​</a></h3><p>将特定的npm包更新到最新版本。</p><div class="language-go line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#82AAFF;">UpdatePackage</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;">ctx context</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">Context</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> pkg </span><span style="color:#C792EA;">string</span><span style="color:#89DDFF;">)</span><span style="color:#C792EA;"> error</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><strong>参数:</strong></p><ul><li><code>ctx</code> (context.Context): 用于取消和超时的上下文</li><li><code>pkg</code> (string): 要更新的包名</li></ul><p><strong>返回:</strong></p><ul><li><code>error</code>: 如果更新失败返回错误</li></ul><p><strong>示例:</strong></p><div class="language-go line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#BABED8;">ctx </span><span style="color:#89DDFF;">:=</span><span style="color:#BABED8;"> context</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Background</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#BABED8;">err </span><span style="color:#89DDFF;">:=</span><span style="color:#BABED8;"> client</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">UpdatePackage</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;">ctx</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">lodash</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#BABED8;"> err </span><span style="color:#89DDFF;">!=</span><span style="color:#89DDFF;"> nil</span><span style="color:#89DDFF;"> {</span></span>
<span class="line"><span style="color:#BABED8;">    log</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Fatalf</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">更新包失败: </span><span style="color:#F07178;">%v</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> err</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="listpackages" tabindex="-1">ListPackages <a class="header-anchor" href="#listpackages" aria-label="Permalink to &quot;ListPackages&quot;">​</a></h3><p>列出当前项目中已安装的包。</p><div class="language-go line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#82AAFF;">ListPackages</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;">ctx context</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">Context</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> options ListOptions</span><span style="color:#89DDFF;">)</span><span style="color:#89DDFF;"> ([]</span><span style="color:#BABED8;">Package</span><span style="color:#89DDFF;">,</span><span style="color:#C792EA;"> error</span><span style="color:#89DDFF;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><strong>参数:</strong></p><ul><li><code>ctx</code> (context.Context): 用于取消和超时的上下文</li><li><code>options</code> (ListOptions): 列表选项</li></ul><p><strong>返回:</strong></p><ul><li><code>[]Package</code>: 已安装包的列表</li><li><code>error</code>: 如果列表获取失败返回错误</li></ul><p><strong>示例:</strong></p><div class="language-go line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#BABED8;">ctx </span><span style="color:#89DDFF;">:=</span><span style="color:#BABED8;"> context</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Background</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#BABED8;">options </span><span style="color:#89DDFF;">:=</span><span style="color:#FFCB6B;"> npm</span><span style="color:#89DDFF;">.</span><span style="color:#FFCB6B;">ListOptions</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#BABED8;">    Global</span><span style="color:#89DDFF;">:</span><span style="color:#FF9CAC;">     false</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#BABED8;">    Depth</span><span style="color:#89DDFF;">:</span><span style="color:#F78C6C;">      1</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#BABED8;">    WorkingDir</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">/path/to/project</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#BABED8;">    JSON</span><span style="color:#89DDFF;">:</span><span style="color:#FF9CAC;">       true</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">packages</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> err </span><span style="color:#89DDFF;">:=</span><span style="color:#BABED8;"> client</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">ListPackages</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;">ctx</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> options</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#BABED8;"> err </span><span style="color:#89DDFF;">!=</span><span style="color:#89DDFF;"> nil</span><span style="color:#89DDFF;"> {</span></span>
<span class="line"><span style="color:#BABED8;">    log</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Fatalf</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">列出包失败: </span><span style="color:#F07178;">%v</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> err</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">for</span><span style="color:#BABED8;"> _</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> pkg </span><span style="color:#89DDFF;">:=</span><span style="color:#89DDFF;font-style:italic;"> range</span><span style="color:#BABED8;"> packages </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#BABED8;">    fmt</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Printf</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">包: </span><span style="color:#F07178;">%s</span><span style="color:#C3E88D;">@</span><span style="color:#F07178;">%s</span><span style="color:#BABED8;">\\n</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> pkg</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">Name</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> pkg</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">Version</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h2 id="脚本执行" tabindex="-1">脚本执行 <a class="header-anchor" href="#脚本执行" aria-label="Permalink to &quot;脚本执行&quot;">​</a></h2><h3 id="runscript" tabindex="-1">RunScript <a class="header-anchor" href="#runscript" aria-label="Permalink to &quot;RunScript&quot;">​</a></h3><p>执行package.json中定义的npm脚本。</p><div class="language-go line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#82AAFF;">RunScript</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;">ctx context</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">Context</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> script </span><span style="color:#C792EA;">string</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> args </span><span style="color:#89DDFF;">...</span><span style="color:#C792EA;">string</span><span style="color:#89DDFF;">)</span><span style="color:#C792EA;"> error</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><strong>参数:</strong></p><ul><li><code>ctx</code> (context.Context): 用于取消和超时的上下文</li><li><code>script</code> (string): 要执行的脚本名称</li><li><code>args</code> (...string): 传递给脚本的额外参数</li></ul><p><strong>返回:</strong></p><ul><li><code>error</code>: 如果脚本执行失败返回错误</li></ul><p><strong>示例:</strong></p><div class="language-go line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#BABED8;">ctx </span><span style="color:#89DDFF;">:=</span><span style="color:#BABED8;"> context</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Background</span><span style="color:#89DDFF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// 运行构建脚本</span></span>
<span class="line"><span style="color:#BABED8;">err </span><span style="color:#89DDFF;">:=</span><span style="color:#BABED8;"> client</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">RunScript</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;">ctx</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">build</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#BABED8;"> err </span><span style="color:#89DDFF;">!=</span><span style="color:#89DDFF;"> nil</span><span style="color:#89DDFF;"> {</span></span>
<span class="line"><span style="color:#BABED8;">    log</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Fatalf</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">运行构建脚本失败: </span><span style="color:#F07178;">%v</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> err</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// 运行带参数的测试脚本</span></span>
<span class="line"><span style="color:#BABED8;">err </span><span style="color:#89DDFF;">=</span><span style="color:#BABED8;"> client</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">RunScript</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;">ctx</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">test</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">--verbose</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">--coverage</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#BABED8;"> err </span><span style="color:#89DDFF;">!=</span><span style="color:#89DDFF;"> nil</span><span style="color:#89DDFF;"> {</span></span>
<span class="line"><span style="color:#BABED8;">    log</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Fatalf</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">运行测试脚本失败: </span><span style="color:#F07178;">%v</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> err</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h2 id="发布" tabindex="-1">发布 <a class="header-anchor" href="#发布" aria-label="Permalink to &quot;发布&quot;">​</a></h2><h3 id="publish" tabindex="-1">Publish <a class="header-anchor" href="#publish" aria-label="Permalink to &quot;Publish&quot;">​</a></h3><p>将当前包发布到npm注册表。</p><div class="language-go line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#82AAFF;">Publish</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;">ctx context</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">Context</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> options PublishOptions</span><span style="color:#89DDFF;">)</span><span style="color:#C792EA;"> error</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><strong>参数:</strong></p><ul><li><code>ctx</code> (context.Context): 用于取消和超时的上下文</li><li><code>options</code> (PublishOptions): 发布选项</li></ul><p><strong>返回:</strong></p><ul><li><code>error</code>: 如果发布失败返回错误</li></ul><p><strong>示例:</strong></p><div class="language-go line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#BABED8;">ctx </span><span style="color:#89DDFF;">:=</span><span style="color:#BABED8;"> context</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Background</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#BABED8;">options </span><span style="color:#89DDFF;">:=</span><span style="color:#FFCB6B;"> npm</span><span style="color:#89DDFF;">.</span><span style="color:#FFCB6B;">PublishOptions</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#BABED8;">    Tag</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;">        &quot;</span><span style="color:#C3E88D;">latest</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#BABED8;">    Access</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;">     &quot;</span><span style="color:#C3E88D;">public</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#BABED8;">    Registry</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;">   &quot;</span><span style="color:#C3E88D;">https://registry.npmjs.org/</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#BABED8;">    WorkingDir</span><span style="color:#89DDFF;">:</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">/path/to/project</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#BABED8;">    DryRun</span><span style="color:#89DDFF;">:</span><span style="color:#FF9CAC;">     false</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">err </span><span style="color:#89DDFF;">:=</span><span style="color:#BABED8;"> client</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Publish</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;">ctx</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> options</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#BABED8;"> err </span><span style="color:#89DDFF;">!=</span><span style="color:#89DDFF;"> nil</span><span style="color:#89DDFF;"> {</span></span>
<span class="line"><span style="color:#BABED8;">    log</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Fatalf</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">发布包失败: </span><span style="color:#F07178;">%v</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> err</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h2 id="信息检索" tabindex="-1">信息检索 <a class="header-anchor" href="#信息检索" aria-label="Permalink to &quot;信息检索&quot;">​</a></h2><h3 id="getpackageinfo" tabindex="-1">GetPackageInfo <a class="header-anchor" href="#getpackageinfo" aria-label="Permalink to &quot;GetPackageInfo&quot;">​</a></h3><p>从npm注册表检索包的详细信息。</p><div class="language-go line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#82AAFF;">GetPackageInfo</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;">ctx context</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">Context</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> pkg </span><span style="color:#C792EA;">string</span><span style="color:#89DDFF;">)</span><span style="color:#89DDFF;"> (*</span><span style="color:#BABED8;">PackageInfo</span><span style="color:#89DDFF;">,</span><span style="color:#C792EA;"> error</span><span style="color:#89DDFF;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><strong>参数:</strong></p><ul><li><code>ctx</code> (context.Context): 用于取消和超时的上下文</li><li><code>pkg</code> (string): 要获取信息的包名</li></ul><p><strong>返回:</strong></p><ul><li><code>*PackageInfo</code>: 详细的包信息</li><li><code>error</code>: 如果信息检索失败返回错误</li></ul><p><strong>示例:</strong></p><div class="language-go line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#BABED8;">ctx </span><span style="color:#89DDFF;">:=</span><span style="color:#BABED8;"> context</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Background</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#BABED8;">info</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> err </span><span style="color:#89DDFF;">:=</span><span style="color:#BABED8;"> client</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">GetPackageInfo</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;">ctx</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">lodash</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#BABED8;"> err </span><span style="color:#89DDFF;">!=</span><span style="color:#89DDFF;"> nil</span><span style="color:#89DDFF;"> {</span></span>
<span class="line"><span style="color:#BABED8;">    log</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Fatalf</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">获取包信息失败: </span><span style="color:#F07178;">%v</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> err</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#BABED8;">fmt</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Printf</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">包: </span><span style="color:#F07178;">%s</span><span style="color:#C3E88D;">@</span><span style="color:#F07178;">%s</span><span style="color:#BABED8;">\\n</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> info</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">Name</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> info</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">Version</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#BABED8;">fmt</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Printf</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">描述: </span><span style="color:#F07178;">%s</span><span style="color:#BABED8;">\\n</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> info</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">Description</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#BABED8;">fmt</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Printf</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">主页: </span><span style="color:#F07178;">%s</span><span style="color:#BABED8;">\\n</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> info</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">Homepage</span><span style="color:#89DDFF;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="search" tabindex="-1">Search <a class="header-anchor" href="#search" aria-label="Permalink to &quot;Search&quot;">​</a></h3><p>在npm注册表中搜索包。</p><div class="language-go line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#82AAFF;">Search</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;">ctx context</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">Context</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> query </span><span style="color:#C792EA;">string</span><span style="color:#89DDFF;">)</span><span style="color:#89DDFF;"> ([]</span><span style="color:#BABED8;">SearchResult</span><span style="color:#89DDFF;">,</span><span style="color:#C792EA;"> error</span><span style="color:#89DDFF;">)</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p><strong>参数:</strong></p><ul><li><code>ctx</code> (context.Context): 用于取消和超时的上下文</li><li><code>query</code> (string): 搜索查询</li></ul><p><strong>返回:</strong></p><ul><li><code>[]SearchResult</code>: 搜索结果列表</li><li><code>error</code>: 如果搜索失败返回错误</li></ul><p><strong>示例:</strong></p><div class="language-go line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#BABED8;">ctx </span><span style="color:#89DDFF;">:=</span><span style="color:#BABED8;"> context</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Background</span><span style="color:#89DDFF;">()</span></span>
<span class="line"><span style="color:#BABED8;">results</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> err </span><span style="color:#89DDFF;">:=</span><span style="color:#BABED8;"> client</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Search</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;">ctx</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">react hooks</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#BABED8;"> err </span><span style="color:#89DDFF;">!=</span><span style="color:#89DDFF;"> nil</span><span style="color:#89DDFF;"> {</span></span>
<span class="line"><span style="color:#BABED8;">    log</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Fatalf</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">搜索包失败: </span><span style="color:#F07178;">%v</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> err</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">for</span><span style="color:#BABED8;"> _</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> result </span><span style="color:#89DDFF;">:=</span><span style="color:#89DDFF;font-style:italic;"> range</span><span style="color:#BABED8;"> results </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#BABED8;">    fmt</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Printf</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">包: </span><span style="color:#F07178;">%s</span><span style="color:#C3E88D;">@</span><span style="color:#F07178;">%s</span><span style="color:#BABED8;">\\n</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> result</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">Package</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">Name</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> result</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">Package</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">Version</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#BABED8;">    fmt</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Printf</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">描述: </span><span style="color:#F07178;">%s</span><span style="color:#BABED8;">\\n</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> result</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">Package</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">Description</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#BABED8;">    fmt</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Printf</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">评分: </span><span style="color:#F07178;">%.2f</span><span style="color:#BABED8;">\\n</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> result</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">Score</span><span style="color:#89DDFF;">.</span><span style="color:#BABED8;">Final</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#BABED8;">    fmt</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">---</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h2 id="错误处理" tabindex="-1">错误处理 <a class="header-anchor" href="#错误处理" aria-label="Permalink to &quot;错误处理&quot;">​</a></h2><p>客户端方法返回结构化错误，可以检查特定条件：</p><div class="language-go line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki material-theme-palenight vp-code" tabindex="0"><code><span class="line"><span style="color:#BABED8;">err </span><span style="color:#89DDFF;">:=</span><span style="color:#BABED8;"> client</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">InstallPackage</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;">ctx</span><span style="color:#89DDFF;">,</span><span style="color:#89DDFF;"> &quot;</span><span style="color:#C3E88D;">nonexistent-package</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#FFCB6B;"> npm</span><span style="color:#89DDFF;">.</span><span style="color:#FFCB6B;">InstallOptions</span><span style="color:#89DDFF;">{})</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#BABED8;"> err </span><span style="color:#89DDFF;">!=</span><span style="color:#89DDFF;"> nil</span><span style="color:#89DDFF;"> {</span></span>
<span class="line"><span style="color:#89DDFF;font-style:italic;">    if</span><span style="color:#BABED8;"> npm</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">IsPackageNotFound</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;">err</span><span style="color:#89DDFF;">)</span><span style="color:#89DDFF;"> {</span></span>
<span class="line"><span style="color:#BABED8;">        fmt</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">包未找到</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#89DDFF;">    }</span><span style="color:#89DDFF;font-style:italic;"> else</span><span style="color:#89DDFF;font-style:italic;"> if</span><span style="color:#BABED8;"> npm</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">IsNpmNotFound</span><span style="color:#89DDFF;">(</span><span style="color:#BABED8;">err</span><span style="color:#89DDFF;">)</span><span style="color:#89DDFF;"> {</span></span>
<span class="line"><span style="color:#BABED8;">        fmt</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Println</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">npm未安装</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#89DDFF;">    }</span><span style="color:#89DDFF;font-style:italic;"> else</span><span style="color:#89DDFF;"> {</span></span>
<span class="line"><span style="color:#BABED8;">        fmt</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">Printf</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">其他错误: </span><span style="color:#F07178;">%v</span><span style="color:#BABED8;">\\n</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#BABED8;"> err</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#89DDFF;">    }</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h2 id="最佳实践" tabindex="-1">最佳实践 <a class="header-anchor" href="#最佳实践" aria-label="Permalink to &quot;最佳实践&quot;">​</a></h2><ol><li><strong>始终使用context</strong>: 传递适当的context以进行超时和取消控制</li><li><strong>检查可用性</strong>: 在执行操作之前使用<code>IsAvailable()</code></li><li><strong>处理错误</strong>: 检查特定错误类型以便更好地处理错误</li><li><strong>使用选项</strong>: 使用选项结构体配置操作以获得灵活性</li><li><strong>工作目录</strong>: 在选项中设置适当的工作目录以进行项目特定操作</li></ol>`,134)]))}const u=n(o,[["render",e]]);export{y as __pageData,u as default};
